# components/purchase-order-create.yaml
type: object
required:
  - order_date
  - supplier_id
  - items
properties:
  order_date:
    type: string
    format: date
    description: Date when the purchase order was created (YYYY-MM-DD)
    example: "2024-01-15"
  supplier_id:
    type: integer
    description: ID of the supplier
    example: 123
  warehouse_id:
    type: integer
    nullable: true
    description: ID of the warehouse
    example: 1
  location_id:
    type: integer
    nullable: true
    description: ID of the location
    example: 1
  order_status:
    type: string
    enum: [active, completed, deleted]
    nullable: true
    default: active
    description: Status of the purchase order
    example: "active"
  order_numbers:
    type: array
    nullable: true
    description: Array of purchase order numbers used to identify the purchase order across various systems
    items:
      type: string
      maxLength: 255
    example: ["PO-2024-001", "SUPPLIER-PO-123"]
  invoice_date:
    type: string
    format: date
    nullable: true
    description: Date when the purchase order was invoiced (YYYY-MM-DD)
    example: "2024-01-16"
  total_shipping_cost:
    type: number
    format: float
    minimum: 0
    nullable: true
    default: 0
    description: Total shipping cost
    example: 50.00
  total_tax:
    type: number
    format: float
    minimum: 0
    nullable: true
    default: 0
    description: Total tax amount
    example: 80.00
  public_note:
    type: string
    nullable: true
    description: Public notes visible to suppliers
    example: "Please ship via express delivery"
  private_note:
    type: string
    nullable: true
    description: Internal private notes
    example: "Rush order - expedite processing"
  requested_ship_date:
    type: string
    format: date
    nullable: true
    description: Requested shipping date (YYYY-MM-DD)
    example: "2024-01-20"
  arrival_due_date:
    type: string
    format: date
    nullable: true
    description: Expected arrival date (YYYY-MM-DD)
    example: "2024-01-25"
  ship_to:
    type: object
    nullable: true
    description: Shipping address information
    properties:
      address_1:
        type: string
        maxLength: 255
        nullable: true
        description: Primary street address
        example: "123 Main Street"
      address_2:
        type: string
        maxLength: 255
        nullable: true
        description: Secondary address line (apt, suite, etc.)
        example: "Suite 100"
      city:
        type: string
        maxLength: 255
        nullable: true
        description: City name
        example: "Anytown"
      state:
        type: string
        maxLength: 255
        nullable: true
        description: State or province
        example: "CA"
      zip:
        type: string
        maxLength: 255
        nullable: true
        description: ZIP or postal code
        example: "90210"
      country:
        type: string
        maxLength: 255
        nullable: true
        description: Country name
        example: "United States"
      default_ship_to_address:
        type: string
        enum: [ship_to_address, warehouse]
        nullable: true
        description: Default shipping address preference
        example: "warehouse"
  items:
    type: array
    minItems: 1
    description: Array of line items for the purchase order
    items:
      type: object
      required:
        - quantity
        - unit_price
      properties:
        id:
          type: integer
          nullable: true
          description: Line item ID (only used for updates)
          example: 456
        product_id:
          type: integer
          nullable: true
          description: ID of the product (required if sku not provided)
          example: 123
        sku:
          type: string
          maxLength: 255
          nullable: true
          description: SKU of the product (required if product_id not provided)
          example: "WIDGET-001"
        quantity:
          type: number
          format: float
          minimum: 0.001
          description: Quantity of the item ordered
          example: 10.5
        unit_price:
          type: number
          format: float
          description: Price per unit
          example: 49.99
        ordered_qty:
          type: number
          format: float
          minimum: 0.001
          nullable: true
          description: Ordered quantity in base unit of measure (calculated automatically if not provided)
          example: 10.5
        received_qty:
          type: number
          format: float
          minimum: 0
          nullable: true
          default: 0
          description: Quantity already received
          example: 5.0
        lot_id:
          type: integer
          nullable: true
          description: ID of the product lot
          example: 789
        uom_id:
          type: integer
          nullable: true
          description: ID of the unit of measure for the item
          example: 1
        source_sku:
          type: string
          maxLength: 255
          nullable: true
          description: Source SKU from the supplier
          example: "SUPPLIER-SKU-123"
        tags:
          type: array
          nullable: true
          description: Tags to associate with this line item
          items:
            type: string
            maxLength: 255
          example: ["priority", "fragile"]
        custom_fields:
          type: object
          nullable: true
          description: Custom field values for this line item
          additionalProperties:
            oneOf:
              - type: string
              - type: number
              - type: boolean
          example:
            "Lot Number": "LOT-12345"
            "Expiry Date": "2024-12-31"
  payments:
    type: array
    nullable: true
    description: |
      Array of payments for this purchase order. If provided, replaces all existing payments.
      Totals are automatically recalculated after payments are updated.
    items:
      type: object
      required:
        - payment_date
        - payment_type
        - paid_amount
      properties:
        payment_date:
          type: string
          format: date
          description: Date of the payment (YYYY-MM-DD)
          example: "2024-01-15"
        payment_type:
          type: string
          enum: [cash, credit_card, debit_card, check, bank_transfer]
          description: Type of payment
          example: "check"
        paid_amount:
          type: number
          format: float
          minimum: 0.01
          description: Amount paid
          example: 500.00
        remarks:
          type: string
          maxLength: 1000
          nullable: true
          description: Payment remarks or notes
          example: "Check #1234"
        external_id:
          type: string
          maxLength: 255
          nullable: true
          description: External payment reference ID
          example: "PAY-EXT-12345"
  custom_fields:
    type: object
    nullable: true
    description: Custom field values for the purchase order
    additionalProperties:
      oneOf:
        - type: string
        - type: number
        - type: boolean
    example:
      "Customer PO": "PO-98765"
      "Priority Level": "High"
  tags:
    type: array
    nullable: true
    description: Tags to associate with the purchase order
    items:
      type: string
      maxLength: 255
    example: ["urgent", "priority", "rush-order"]

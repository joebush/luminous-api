get:
  operationId: getCompanies
  tags:
    - Companies
  summary: Companies
  description: |
    Get a paginated list of companies with optional filtering and sorting.
    
    For detailed information about the filtering system and available operators, 
    refer to the [Filter System Documentation](/filters).

    ## Available Sort Fields

    - `id` - Sort by company ID
    - `created_at` - Sort by creation date (default: `updated_at:desc`)
    - `updated_at` - Sort by last update date (default: `updated_at:desc`)

    Sort format: `field:direction` where direction is `asc` (ascending) or `desc` (descending).
    
    Examples:
    - `?sort=id:asc` - Sort by ID ascending
    - `?sort=created_at:desc` - Sort by creation date descending
    - `?sort=updated_at:asc` - Sort by update date ascending

    ## Available Filters
    ### String Filters
    - `name`: Company name
    - `type`: Type of business
    - `city`: City
    - `state`: State
    - `country`: Country
    - `zip`: ZIP/Postal code
    - `phone`: Phone number
    - `payment_term`: Payment term
    - `status`: Company status
    - `tag`: Filter by tag name
    
    ### DateTime Filters
    - `created_at`: When the company was created
    - `updated_at`: When the company was last updated
    
    ### Custom Field Filters
    Custom fields can be filtered using their field names. Custom field filters are dynamically 
    generated based on the custom fields defined for companies in your system.
    
    Custom field filters use the format `custom_fields.{field_label}` where `{field_label}` is 
    the exact label of the custom field as defined in your system. The available operators depend 
    on the custom field type:
    
    - **String/Dropdown fields**: `eq`, `neq`, `contains`, `notcontains`, `in`, `notin`, `set`, `notset`
    - **Number fields**: `eq`, `neq`, `gt`, `gte`, `lt`, `lte`, `in`, `notin`, `set`, `notset`
    - **Date fields**: `eq`, `neq`, `gt`, `gte`, `lt`, `lte`, `set`, `notset`
    
    **Note**: Custom field labels may contain spaces or special characters. When using them in URLs, 
    ensure proper URL encoding (e.g., spaces become `%20` or `+`).
    
    ## Examples
    ```
    # Find companies by name
    ?name[eq]=Acme Corp

    # Find companies in a specific state
    ?state[eq]=CA

    # Find companies with a specific payment term
    ?payment_term[eq]=Net 30

    # Find companies by tag
    ?tag[eq]=VIP

    # Find companies by status
    ?status[eq]=active

    # Filter by custom field (string) - exact match
    ?custom_fields.Industry[eq]=Manufacturing

    # Filter by custom field (string) - contains
    ?custom_fields.Region[contains]=West

    # Filter by custom field (number) - greater than
    ?custom_fields.Annual Revenue[gt]=1000000

    # Filter by custom field (number) - range
    ?custom_fields.Employee Count[gte]=50&custom_fields.Employee Count[lte]=200

    # Filter by custom field (date) - after date
    ?custom_fields.Contract Start Date[gte]=2024-01-01

    # Filter by custom field (dropdown) - multiple values
    ?custom_fields.Customer Tier[in]=Premium,Enterprise

    # Filter by custom field - has value set
    ?custom_fields.Industry[set]=true

    # Filter by custom field - no value set
    ?custom_fields.Notes[notset]=true

    # Combine custom field filter with other filters
    ?state[eq]=CA&custom_fields.Industry[eq]=Retail&tag[eq]=VIP
    ```
  security:
    - BearerAuth: []
  parameters:
    - $ref: './components/parameters/page.yaml'
    - $ref: './components/parameters/limit.yaml'
    - in: query
      name: sort
      schema:
        type: string
        default: 'updated_at:desc'
      description: |
        Sort results by field and direction. Format: `field:direction`
        
        Available sort fields:
        - `id` - Company ID
        - `created_at` - Creation date
        - `updated_at` - Last update date (default)
        
        Examples:
        - `id:asc` - Sort by ID ascending
        - `created_at:desc` - Sort by creation date descending
        - `updated_at:asc` - Sort by update date ascending
    - in: query
      name: name
      schema:
        type: string
      description: Filter by company name
    - in: query
      name: type
      schema:
        type: string
      description: Filter by business type
    - in: query
      name: phone
      schema:
        type: string
      description: Filter by phone number
    - in: query
      name: city
      schema:
        type: string
      description: Filter by city
    - in: query
      name: state
      schema:
        type: string
      description: Filter by state
    - in: query
      name: country
      schema:
        type: string
      description: Filter by country
    - in: query
      name: zip
      schema:
        type: string
      description: Filter by ZIP/Postal code
    - in: query
      name: payment_term
      schema:
        type: string
      description: Filter by payment term
    - in: query
      name: status
      schema:
        type: string
      description: Filter by company status
    - in: query
      name: tag
      schema:
        type: string
      description: Filter by tag name
    - in: query
      name: created_at
      schema:
        type: string
        format: date-time
      description: Filter by creation date
    - in: query
      name: updated_at
      schema:
        type: string
        format: date-time
      description: Filter by last update date
    
  responses:
    '200':
      description: A list of companies
      content:
        application/json:
          schema:
            type: object
            properties:
              data:
                type: array
                items:
                  $ref: './components/company.yaml'
              meta:
                $ref: './components/pagination-meta.yaml'
    '401':
      $ref: './components/responses/unauthorized.yaml'
    '403':
      $ref: './components/responses/forbidden.yaml'

post:
  operationId: createCompany
  tags:
    - Companies
  summary: Create a company
  description: Create a new company with optional tags, custom fields, and shipping addresses
  security:
    - BearerAuth: []
  requestBody:
    required: true
    content:
      application/json:
        schema:
          $ref: './components/company-create.yaml'
  responses:
    '201':
      description: Company successfully created
      content:
        application/json:
          schema:
            type: object
            properties:
              data:
                $ref: './components/company.yaml'
    '422':
      description: Validation error
      content:
        application/json:
          schema:
            $ref: './components/validation-error.yaml'
    '401':
      $ref: './components/responses/unauthorized.yaml'
    '403':
      $ref: './components/responses/forbidden.yaml' 